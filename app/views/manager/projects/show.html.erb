<%= render 'layouts/project', type: current_user.type%>

<h1>Change Requests</h1>

<table>
  <thead>
    <th>Title</th>
    <th>Type</th>
    <th>Deadline</th>
    <th>Status</th>
    <th>Posted by</th>
    <th>Assigned Developers</th>
    <th colspan=3>Links</th>
  </thead>
  <tbody>
    <% @change_requests.each do |change| %>
    <tr>
      <td><%= change.title%></td>
      <td><%= change.type%></td>
      <td><%= change.deadline%></td>
      <td><%= change.status%></td>
      <td><%= QualityAssurance.find(change.user_id).email%></td>
      <td><%= change.developers.count %></td>
      <td><%= link_to 'show', manager_change_request_path(change) %></td></td>
    </tr>
    <% end %>
  </tbody>
</table>

<h1>Developers</h1>
<%= form_with url: developers_manager_project_path(@project), local: true do |form| %>
  <%= collection_select(:developer, :user_id, Developer.all, :id, :email) %>
  <%= form.submit 'Add Developer'%>
<% end %>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Links</th>
    </tr>
    <% @developers.each do |dev| %>
      <tr>
        <td><%= "#{dev.first_name} #{dev.last_name}" %></td>
        <td><%= dev.email %></td>
        <td><%= link_to 'Remove', developer_manager_project_path(@project, dev), method: :delete%></td>
      </tr>
    <% end %>
  </thead>
</table>

<h1>Quality Assurers</h1>

<%= form_with url: qas_manager_project_path(@project), local: true do |form| %>
  <%= collection_select(:qa, :user_id, QualityAssurance.all, :id, :email) %>
  <%= form.submit 'Add Quality Assurer'%>
<% end %>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Links</th>
    </tr>
    <% @qas.each do |qa| %>
      <tr>
        <td><%= "#{qa.first_name} #{qa.last_name}" %></td>
        <td><%= qa.email %></td>
        <td><%= link_to 'Remove', qa_manager_project_path(@project, qa), method: :delete%></td>
      </tr>
    <% end %>
  </thead>
</table>
